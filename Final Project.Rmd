---
title: "Project Outline"
output: html_document
---

```{r}
require(tidyverse)
require(jsonlite)
require(httr)
require(devtools)
require(jsonlite)
require(dplyr)
require(readr)
library(shiny)
library(shinyjs)
library(leaflet)
library(maps)


ny <- read_csv("data/meetup_groupsNYlocation.csv",  col_names = FALSE)
bo <- read_csv("data/Boston_MA.csv", col_names= TRUE)
ch <- read_csv("data/Charlotte_NC.csv", col_names=TRUE)
ha <- read_csv("data/Hartford_CT.csv", col_names=TRUE)

#top categories based on members
top10 <- function(data) {
  data %>%
    group_by(category) %>%
    summarize(members_tot = sum(members))  %>%
    arrange(desc(members_tot)) %>%
    head(10) %>% 
    
}
dplyr::do(top10, data= .)

 top10(data=ch)
 top10(data=ha)
top10(data=bo)
top10(data=ny) 
#Renaming columns
colnames(ny)[1] <- "city"
colnames(ny)[2] <- "group_name"
colnames(ny)[3] <- "created"
colnames(ny)[4] <- "category"
colnames(ny)[5] <- "members"
colnames(ny)[6] <- "details"
colnames(ny)[7] <- "lat"
colnames(ny)[8] <- "long"
```


```{r}
#creates df topics with number of groups per topic
topics <- ny %>% 
  select(category, members) %>% 
  group_by(category) %>% 
  summarise(count = n(), total_members= sum(members)) %>% 
  arrange(desc(count));topics

topics10 <- topics %>% 
  head(10)
  
#graph of densities of topics
ggplot( data = topics, aes(x = count)) + geom_density(adjust = 0.29) + labs(title = "") 

#graph of number of members in top 10 topics (stacked bargraph)

```

```{r}
socializing <- ny %>% 
  filter(category == "socializing")

language <- ny %>% 
  filter(category == "language/ethnic identity")

tech <- ny %>% 
  filter(category == "tech")

sports <- ny %>% 
  filter(category == "sports/recreation")
```


As you can see, the category with the most groups is "socializing". Given how at it's core meetup is designed to bring people together over shared interests, it is no wonder that socializing has the highest volume of meetup groups. The majority of topics (approxiamately 30%) have between 5 and 25 dedicated groups.


```{r}
smallCT <- Hartford_CT %>% 
  select(category, lat, lon)
smallCT <- na.omit(smallCT)
```

```{r}
smallMA <- Boston_MA %>% 
  select(category, lat, lon)
smallMA <- na.omit(smallMA)
```

```{r}
smallNC <- Charlotte_NC %>% 
  select(category, lat, lon)
smallNC <- na.omit(smallNC)
```

#Shiny Time

```{r}
#Template
Aukland <- leaflet() %>%
  addTiles() %>%  # Add default OpenStreetMap map tiles
  addMarkers(lng=174.768, lat=-36.852, popup="The birthplace of R")
Aukland  # Print the map
```

```{r}
#Map of the the Northeast, with event markers for social, language, sports, and tech in New York
mapStates = map("state", region = c('new york', 'new jersey', 'penn'),fill = TRUE, plot = FALSE)
leaflet(data = mapStates) %>% addTiles() %>%
  addPolygons(fillColor = topo.colors(10, alpha = NULL), stroke = FALSE) %>% 
  addMarkers(data=socializing, popup="social") %>% 
  addMarkers(data=language, popup="language") %>% 
  addMarkers(data=sports, popup="sports") %>% 
  addMarkers(data=tech, popup="tech") %>% 
  addMarkers(data=tech, popup="tech")
```


```{r}
# map of NY with events as category
NY  <- leaflet() %>%
  addTiles() %>%  
  #markers(Hartford)# Add default OpenStreetMap map tiles
  addMarkers(data=socializing, popup="social") %>% 
  addMarkers(data=language, popup="language") %>% 
  addMarkers(data=sports, popup="sports") %>% 
  addMarkers(data=tech, popup="tech")
NY
```

```{r}
ui <- fluidPage()

server <- function(input, ouput) {}

ShinyApp(ui=ui, server=server)
```


```{r}
shinyServer(function(input, output, session){
    output$mymap <- renderLeaflet({
      leaflet() %>% 
        addTiles() %>% 
        setView(lng =-72.6851, lat =41.7637) %>% 
        addMarkers(data = socializing, lat =, group = "socializing")
    })
})

```





